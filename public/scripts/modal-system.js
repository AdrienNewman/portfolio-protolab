/**
 * Modal System - 2-Level Architecture
 * Level 1: Preview modals (hover cards)
 * Level 2: Detail modals (full content)
 */

let cardHoverTimeout = null;
let modalHoverTimeout = null;

function initModals() {
    const skillCards = document.querySelectorAll('[data-preview]');
    const projectCards = document.querySelectorAll('[data-project]');
    const detailOverlays = document.querySelectorAll('.modal-overlay');
    const previewModals = document.querySelectorAll('.skill-preview-modal');

    // SKILL CARDS - Preview Modal Logic
    skillCards.forEach(card => {
        const previewId = card.dataset.preview;
        const detailId = card.dataset.modal;
        const previewModal = document.getElementById(previewId);
        const detailModal = document.getElementById(detailId);

        if (!previewModal || !detailModal) {
            console.warn(`Modal not found for card:`, { previewId, detailId });
            return;
        }

        // Hover handling - Show preview after 200ms delay
        card.addEventListener('mouseenter', (e) => {
            clearTimeout(cardHoverTimeout);
            clearTimeout(modalHoverTimeout);

            cardHoverTimeout = setTimeout(() => {
                closeAllPreviews();
                if (previewModal) {
                    previewModal.classList.add('active');
                    requestAnimationFrame(() => {
                        positionPreviewModal(previewModal, card);
                    });
                }
            }, 200);
        });

        // Keep modal open when hovering card
        card.addEventListener('mouseleave', (e) => {
            clearTimeout(cardHoverTimeout);

            modalHoverTimeout = setTimeout(() => {
                if (previewModal && !previewModal.matches(':hover')) {
                    previewModal.classList.remove('active');
                }
            }, 100);
        });

        // Click opens detail modal directly
        card.addEventListener('click', (e) => {
            e.preventDefault();
            closeAllPreviews();
            if (detailModal) {
                detailModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        });
    });

    // PREVIEW MODAL HOVER - Keep open when hovering modal itself
    previewModals.forEach(preview => {
        preview.addEventListener('mouseenter', () => {
            clearTimeout(modalHoverTimeout);
        });

        preview.addEventListener('mouseleave', () => {
            modalHoverTimeout = setTimeout(() => {
                preview.classList.remove('active');
            }, 100);
        });

        // CTA BUTTON - Click opens detail modal
        const ctaBtn = preview.querySelector('.skill-preview-cta');
        const detailModalId = preview.dataset.detailModal;
        const detailModal = document.getElementById(detailModalId);

        if (ctaBtn && detailModal) {
            ctaBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                closeAllPreviews();
                detailModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            });
        }
    });

    // PROJECT CARDS - Open detail modal on click
    projectCards.forEach(card => {
        card.addEventListener('click', () => {
            const projectId = card.dataset.project;
            const modal = document.getElementById(projectId);
            if (modal) {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        });
    });

    // DETAIL MODALS - Close buttons
    document.querySelectorAll('.modal-close').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.stopPropagation();
            closeDetailModals();
        });
    });

    // DETAIL MODALS - Click outside to close
    detailOverlays.forEach(overlay => {
        overlay.addEventListener('click', (e) => {
            if (e.target === overlay) {
                closeDetailModals();
            }
        });
    });

    // ESC key closes everything
    document.addEventListener('keydown', e => {
        if (e.key === 'Escape') {
            closeAllPreviews();
            closeDetailModals();
        }
    });

    // Close previews when scrolling
    let scrollTimeout;
    window.addEventListener('scroll', () => {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(() => {
            closeAllPreviews();
        }, 50);
    }, { passive: true });
}

/**
 * Position preview modal intelligently
 * - Try right side first
 * - Fall back to left if no space
 * - Keep within viewport bounds
 */
function positionPreviewModal(modal, card) {
    const cardRect = card.getBoundingClientRect();
    const modalWidth = 450;
    const modalHeight = modal.offsetHeight;
    const gap = 20;
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;

    let left, top;

    // Try positioning to the right
    left = cardRect.right + gap;

    // If doesn't fit on right, try left
    if (left + modalWidth > viewportWidth - gap) {
        left = cardRect.left - modalWidth - gap;
    }

    // If still doesn't fit, center it
    if (left < gap) {
        left = (viewportWidth - modalWidth) / 2;
    }

    // Vertical positioning - align with card top
    top = cardRect.top;

    // Ensure modal stays within viewport vertically
    if (top + modalHeight > viewportHeight - gap) {
        top = viewportHeight - modalHeight - gap;
    }

    if (top < gap) {
        top = gap;
    }

    // Apply position
    modal.style.left = `${Math.max(gap, left)}px`;
    modal.style.top = `${Math.max(gap, top)}px`;
}

/**
 * Close all preview modals
 */
function closeAllPreviews() {
    document.querySelectorAll('.skill-preview-modal.active').forEach(m => {
        m.classList.remove('active');
    });
}

/**
 * Close all detail modals
 */
function closeDetailModals() {
    document.querySelectorAll('.modal-overlay.active').forEach(m => {
        m.classList.remove('active');
    });
    document.body.style.overflow = '';
}

/**
 * Scroll to section helper (for modal CTA buttons)
 */
function scrollToSection(sectionId) {
    const section = document.getElementById(sectionId);
    if (section) {
        closeDetailModals();
        setTimeout(() => {
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 300);
    }
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initModals);
} else {
    initModals();
}

// Also listen for portfolioReady event (after boot animation)
document.addEventListener('portfolioReady', () => {
    console.log('✓ Modal system initialized after boot');
    initModals();
});

/**
 * ==============================================
 * DOCUMENTATION MODAL SYSTEM
 * ==============================================
 */

// Tag to Icon Mapping (Simple Icons SVG paths)
const TAG_ICON_MAPPING = {
    'grafana': 'M23.02 10.59a8.578 8.578 0 0 0-.862-3.034 8.911 8.911 0 0 0-1.789-2.445c.337-1.342-.413-2.505-.413-2.505-1.292-.08-2.113.4-2.416.62-.052-.02-.102-.044-.154-.064-.22-.089-.446-.172-.677-.247-.231-.073-.47-.14-.711-.197a9.867 9.867 0 0 0-.875-.161C14.557.753 12.94 0 12.94 0c-1.804 1.145-2.147 2.744-2.147 2.744l-.018.093c-.098.029-.2.057-.298.088-.138.042-.275.094-.413.143-.138.055-.275.107-.41.166a8.869 8.869 0 0 0-1.557.87l-.063-.029c-2.497-.955-4.716.195-4.716.195-.203 2.658.996 4.33 1.235 4.636a11.608 11.608 0 0 0-.607 2.635C1.636 12.677.953 15.014.953 15.014c1.926 2.214 4.171 2.351 4.171 2.351.003-.002.006-.002.006-.005.285.509.615.994.986 1.446.156.19.32.371.488.548-.704 2.009.099 3.68.099 3.68 2.144.08 3.553-.937 3.849-1.173a9.784 9.784 0 0 0 3.164.501h.08l.055-.003.107-.002.103-.005.003.002c1.01 1.44 2.788 1.646 2.788 1.646 1.264-1.332 1.337-2.653 1.337-2.94v-.058c0-.02-.003-.039-.003-.06.265-.187.52-.387.758-.6a7.875 7.875 0 0 0 1.415-1.7c1.43.083 2.437-.885 2.437-.885-.236-1.49-1.085-2.216-1.264-2.354l-.018-.013-.016-.013a.217.217 0 0 1-.031-.02c.008-.092.016-.18.02-.27.011-.162.016-.323.016-.48v-.253l-.005-.098-.008-.135a1.891 1.891 0 0 0-.01-.13c-.003-.042-.008-.083-.013-.125l-.016-.124-.018-.122a6.215 6.215 0 0 0-2.032-3.73 6.015 6.015 0 0 0-3.222-1.46 6.292 6.292 0 0 0-.85-.048l-.107.002h-.063l-.044.003-.104.008a4.777 4.777 0 0 0-3.335 1.695c-.332.4-.592.84-.768 1.297a4.594 4.594 0 0 0-.312 1.817l.003.091c.005.055.007.11.013.164a3.615 3.615 0 0 0 .698 1.82 3.53 3.53 0 0 0 1.827 1.282c.33.098.66.14.971.137.039 0 .078 0 .114-.002l.063-.003c.02 0 .041-.003.062-.003.034-.002.065-.007.099-.01.007 0 .018-.003.028-.003l.031-.005.06-.008a1.18 1.18 0 0 0 .112-.02c.036-.008.072-.013.109-.024a2.634 2.634 0 0 0 .914-.415c.028-.02.056-.041.085-.065a.248.248 0 0 0 .039-.35.244.244 0 0 0-.309-.06l-.078.042c-.09.044-.184.083-.283.116a2.476 2.476 0 0 1-.475.096c-.028.003-.054.006-.083.006l-.083.002c-.026 0-.054 0-.08-.002l-.102-.006h-.012l-.024.006c-.016-.003-.031-.003-.044-.006-.031-.002-.06-.007-.091-.01a2.59 2.59 0 0 1-.724-.213 2.557 2.557 0 0 1-.667-.438 2.52 2.52 0 0 1-.805-1.475 2.306 2.306 0 0 1-.029-.444l.006-.122v-.023l.002-.031c.003-.021.003-.04.005-.06a3.163 3.163 0 0 1 1.352-2.29 3.12 3.12 0 0 1 .937-.43 2.946 2.946 0 0 1 .776-.101h.06l.07.002.045.003h.026l.07.005a4.041 4.041 0 0 1 1.635.49 3.94 3.94 0 0 1 1.602 1.662 3.77 3.77 0 0 1 .397 1.414l.005.076.003.075c.002.026.002.05.002.075 0 .024.003.052 0 .07v.065l-.002.073-.008.174a6.195 6.195 0 0 1-.08.639 5.1 5.1 0 0 1-.267.927 5.31 5.31 0 0 1-.624 1.13 5.052 5.052 0 0 1-3.237 2.014 4.82 4.82 0 0 1-.649.066l-.039.003h-.287a6.607 6.607 0 0 1-1.716-.265 6.776 6.776 0 0 1-3.4-2.274 6.75 6.75 0 0 1-.746-1.15 6.616 6.616 0 0 1-.714-2.596l-.005-.083-.002-.02v-.056l-.003-.073v-.096l-.003-.104v-.07l.003-.163c.008-.22.026-.45.054-.678a8.707 8.707 0 0 1 .28-1.355c.128-.444.286-.872.473-1.277a7.04 7.04 0 0 1 1.456-2.1 5.925 5.925 0 0 1 .953-.763c.169-.111.343-.213.524-.306.089-.05.182-.091.273-.135.047-.02.093-.042.138-.062a7.177 7.177 0 0 1 .714-.267l.145-.045c.049-.015.098-.026.148-.041.098-.029.197-.052.296-.076.049-.013.1-.02.15-.033l.15-.032.151-.028.076-.013.075-.01.153-.024c.057-.01.114-.013.171-.023l.169-.021c.036-.003.073-.008.106-.01l.073-.008.036-.003.042-.002c.057-.003.114-.008.171-.01l.086-.006h.023l.037-.003.145-.007a7.999 7.999 0 0 1 1.708.125 7.917 7.917 0 0 1 2.048.68 8.253 8.253 0 0 1 1.672 1.09l.09.077.089.078c.06.052.114.107.171.159.057.052.112.106.166.16.052.055.107.107.159.164a8.671 8.671 0 0 1 1.41 1.978c.012.026.028.052.04.078l.04.078.075.156c.023.051.05.1.07.153l.065.15a8.848 8.848 0 0 1 .45 1.34.19.19 0 0 0 .201.142.186.186 0 0 0 .172-.184c.01-.246.002-.532-.024-.856z',
    'prometheus': 'M12 0C5.373 0 0 5.372 0 12c0 6.627 5.373 12 12 12s12-5.373 12-12c0-6.628-5.373-12-12-12zm0 22.46c-1.885 0-3.414-1.26-3.414-2.814h6.828c0 1.553-1.528 2.813-3.414 2.813zm5.64-3.745H6.36v-2.046h11.28v2.046zm-.04-3.098H6.391c-.037-.043-.075-.086-.111-.13-1.155-1.401-1.427-2.133-1.69-2.879-.005-.025 1.4.287 2.395.511 0 0 .513.119 1.262.255-.72-.843-1.147-1.915-1.147-3.01 0-2.406 1.845-4.508 1.18-6.207.648.053 1.34 1.367 1.387 3.422.689-.951.977-2.69.977-3.755 0-1.103.727-2.385 1.454-2.429-.648 1.069.168 1.984.894 4.256.272.854.237 2.29.447 3.201.07-1.892.395-4.652 1.595-5.605-.529 1.2.079 2.702.494 3.424.671 1.164 1.078 2.047 1.078 3.716a4.642 4.642 0 01-1.11 2.996c.792-.149 1.34-.283 1.34-.283l2.573-.502s-.374 1.538-1.81 3.019z',
    'docker': 'M13.983 11.078h2.119a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.119a.185.185 0 00-.185.185v1.888c0 .102.083.185.185.185m-2.954-5.43h2.118a.186.186 0 00.186-.186V3.574a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m0 2.716h2.118a.187.187 0 00.186-.186V6.29a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.887c0 .102.082.185.185.186m-2.93 0h2.12a.186.186 0 00.184-.186V6.29a.185.185 0 00-.185-.185H8.1a.185.185 0 00-.185.185v1.887c0 .102.083.185.185.186m-2.964 0h2.119a.186.186 0 00.185-.186V6.29a.185.185 0 00-.185-.185H5.136a.186.186 0 00-.186.185v1.887c0 .102.084.185.186.186m5.893 2.715h2.118a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m-2.93 0h2.12a.185.185 0 00.184-.185V9.006a.185.185 0 00-.184-.186h-2.12a.185.185 0 00-.184.185v1.888c0 .102.083.185.185.185m-2.964 0h2.119a.185.185 0 00.185-.185V9.006a.185.185 0 00-.184-.186h-2.12a.186.186 0 00-.186.186v1.887c0 .102.084.185.186.185m-2.92 0h2.12a.185.185 0 00.184-.185V9.006a.185.185 0 00-.184-.186h-2.12a.185.185 0 00-.184.185v1.888c0 .102.082.185.185.185M23.763 9.89c-.065-.051-.672-.51-1.954-.51-.338.001-.676.03-1.01.087-.248-1.7-1.653-2.53-1.716-2.566l-.344-.199-.226.327c-.284.438-.49.922-.612 1.43-.23.97-.09 1.882.403 2.661-.595.332-1.55.413-1.744.42H.751a.751.751 0 00-.75.748 11.376 11.376 0 00.692 4.062c.545 1.428 1.355 2.48 2.41 3.124 1.18.723 3.1 1.137 5.275 1.137.983.003 1.963-.086 2.93-.266a12.248 12.248 0 003.823-1.389c.98-.567 1.86-1.288 2.61-2.136 1.252-1.418 1.998-2.997 2.553-4.4h.221c1.372 0 2.215-.549 2.68-1.009.309-.293.55-.65.707-1.046l.098-.288Z',
    'kubernetes': 'M10.204 14.35l.007.01-.999 2.413a5.171 5.171 0 0 1-2.075-2.597l2.578-.437.004.005a.44.44 0 0 1 .484.606zm-.833-2.129a.44.44 0 0 0 .173-.756l.002-.011L7.585 9.7a5.143 5.143 0 0 0-.73 3.255l2.514-.725.002-.009zm1.145-1.98a.44.44 0 0 0 .699-.337l.01-.005.15-2.62a5.144 5.144 0 0 0-3.01 1.442l2.147 1.523.004-.002zm.76 2.75l.723.349.722-.347.18-.78-.5-.623h-.804l-.5.623.179.779zm1.5-3.095a.44.44 0 0 0 .7.336l.008.003 2.134-1.513a5.188 5.188 0 0 0-2.992-1.442l.148 2.615.002.001zm10.876 5.97l-5.773 7.181a1.6 1.6 0 0 1-1.248.594l-9.261.003a1.6 1.6 0 0 1-1.247-.596l-5.776-7.18a1.583 1.583 0 0 1-.307-1.34L2.1 5.573c.108-.47.425-.864.863-1.073L11.305.513a1.606 1.606 0 0 1 1.385 0l8.345 3.985c.438.209.755.604.863 1.073l2.062 8.955c.108.47-.005.963-.308 1.34zm-3.289-2.057c-.042-.01-.103-.026-.145-.034-.174-.033-.315-.025-.479-.038-.35-.037-.638-.067-.895-.148-.105-.04-.18-.165-.216-.216l-.201-.059a6.45 6.45 0 0 0-.105-2.332 6.465 6.465 0 0 0-.936-2.163c.052-.047.15-.133.177-.159.008-.09.001-.183.094-.282.197-.185.444-.338.743-.522.142-.084.273-.137.415-.242.032-.024.076-.062.11-.089.24-.191.295-.52.123-.736-.172-.216-.506-.236-.745-.045-.034.027-.08.062-.111.088-.134.116-.217.23-.33.35-.246.25-.45.458-.673.609-.097.056-.239.037-.303.033l-.19.135a6.545 6.545 0 0 0-4.146-2.003l-.012-.223c-.065-.062-.143-.115-.163-.25-.022-.268.015-.557.057-.905.023-.163.061-.298.068-.475.001-.04-.001-.099-.001-.142 0-.306-.224-.555-.5-.555-.275 0-.499.249-.499.555l.001.014c0 .041-.002.092 0 .128.006.177.044.312.067.475.042.348.078.637.056.906a.545.545 0 0 1-.162.258l-.012.211a6.424 6.424 0 0 0-4.166 2.003 8.373 8.373 0 0 1-.18-.128c-.09.012-.18.04-.297-.029-.223-.15-.427-.358-.673-.608-.113-.12-.195-.234-.329-.349-.03-.026-.077-.062-.111-.088a.594.594 0 0 0-.348-.132.481.481 0 0 0-.398.176c-.172.216-.117.546.123.737l.007.005.104.083c.142.105.272.159.414.242.299.185.546.338.743.522.076.082.09.226.1.288l.16.143a6.462 6.462 0 0 0-1.02 4.506l-.208.06c-.055.072-.133.184-.215.217-.257.081-.546.11-.895.147-.164.014-.305.006-.48.039-.037.007-.09.02-.133.03l-.004.002-.007.002c-.295.071-.484.342-.423.608.061.267.349.429.645.365l.007-.001.01-.003.129-.029c.17-.046.294-.113.448-.172.33-.118.604-.217.87-.256.112-.009.23.069.288.101l.217-.037a6.5 6.5 0 0 0 2.88 3.596l-.09.218c.033.084.069.199.044.282-.097.252-.263.517-.452.813-.091.136-.185.242-.268.399-.02.037-.045.095-.064.134-.128.275-.034.591.213.71.248.12.556-.007.69-.282v-.002c.02-.039.046-.09.062-.127.07-.162.094-.301.144-.458.132-.332.205-.68.387-.897.05-.06.13-.082.215-.105l.113-.205a6.453 6.453 0 0 0 4.609.012l.106.192c.086.028.18.042.256.155.136.232.229.507.342.84.05.156.074.295.145.457.016.037.043.09.062.129.133.276.442.402.69.282.247-.118.341-.435.213-.71-.02-.039-.045-.096-.065-.134-.083-.156-.177-.261-.268-.398-.19-.296-.346-.541-.443-.793-.04-.13.007-.21.038-.294-.018-.022-.059-.144-.083-.202a6.499 6.499 0 0 0 2.88-3.622c.064.01.176.03.213.038.075-.05.144-.114.28-.104.266.039.54.138.87.256.154.06.277.128.448.173.036.01.088.019.13.028l.009.003.007.001c.297.064.584-.098.645-.365.06-.266-.128-.537-.423-.608zM16.4 9.701l-1.95 1.746v.005a.44.44 0 0 0 .173.757l.003.01 2.526.728a5.199 5.199 0 0 0-.108-1.674A5.208 5.208 0 0 0 16.4 9.7zm-4.013 5.325a.437.437 0 0 0-.404-.232.44.44 0 0 0-.372.233h-.002l-1.268 2.292a5.164 5.164 0 0 0 3.326.003l-1.27-2.296h-.01zm1.888-1.293a.44.44 0 0 0-.27.036.44.44 0 0 0-.214.572l-.003.004 1.01 2.438a5.15 5.15 0 0 0 2.081-2.615l-2.6-.44-.004.005z',
    'linux': 'M12.504 0c-.155 0-.315.008-.48.021-4.226.333-3.105 4.807-3.17 6.298-.076 1.092-.3 1.953-1.05 3.02-.885 1.051-2.127 2.75-2.716 4.521-.278.832-.41 1.684-.287 2.489a.424.424 0 00-.11.135c-.26.268-.45.6-.663.839-.199.199-.485.267-.797.4-.313.136-.658.269-.864.68-.09.189-.136.394-.132.602 0 .199.027.4.055.536.058.399.116.728.04.97-.249.68-.28 1.145-.106 1.484.174.334.535.47.94.601.81.2 1.91.135 2.774.6.926.466 1.866.67 2.616.47.526-.116.97-.464 1.208-.946.587-.003 1.23-.269 2.26-.334.699-.058 1.574.267 2.577.2.025.134.063.198.114.333l.003.003c.391.778 1.113 1.132 1.884 1.071.771-.06 1.592-.536 2.257-1.306.631-.765 1.683-1.084 2.378-1.503.348-.199.629-.469.649-.853.023-.4-.2-.811-.714-1.376v-.097l-.003-.003c-.17-.2-.25-.535-.338-.926-.085-.401-.182-.786-.492-1.046h-.003c-.059-.054-.123-.067-.188-.135a.357.357 0 00-.19-.064c.431-1.278.264-2.55-.173-3.694-.533-1.41-1.465-2.638-2.175-3.483-.796-1.005-1.576-1.957-1.56-3.368.026-2.152.236-6.133-3.544-6.139z',
    'nginx': 'M12 0L1.605 6v12L12 24l10.395-6V6L12 0zm6 16.59c0 .705-.646 1.29-1.529 1.29-.631 0-1.351-.255-1.801-.81l-6-7.141v6.66c0 .721-.57 1.29-1.274 1.29H7.32c-.721 0-1.29-.6-1.29-1.29V7.41c0-.705.63-1.29 1.5-1.29.646 0 1.38.255 1.83.81l5.97 7.141V7.41c0-.721.6-1.29 1.29-1.29h.075c.72 0 1.29.6 1.29 1.29v9.18H18z',
    'proxmox': 'M4.928 1.825c-1.09.553-1.09.64-.07 1.78 5.655 6.295 7.004 7.782 7.107 7.782.139.017 7.971-8.542 8.058-8.801.034-.07-.208-.312-.519-.536-.415-.312-.864-.433-1.712-.467-1.59-.104-2.144.242-4.115 2.455-.899 1.003-1.66 1.833-1.66 1.833-.017 0-.76-.813-1.642-1.798S8.473 2.1 8.127 1.91c-.796-.45-2.421-.484-3.2-.086zM1.297 4.367C.45 4.695 0 5.007 0 5.248c0 .121 1.331 1.678 2.94 3.459 1.625 1.78 2.939 3.268 2.939 3.302 0 .035-1.331 1.522-2.94 3.303C1.314 17.11.017 18.683.035 18.822c.086.467 1.504 1.055 2.541 1.055 1.678-.018 2.058-.312 5.603-4.202 1.78-1.954 3.233-3.614 3.233-3.666 0-.069-1.435-1.694-3.199-3.63-2.3-2.508-3.423-3.632-3.96-3.874-.812-.398-2.126-.467-2.956-.138zm18.467.12c-.502.26-1.764 1.505-3.943 3.891-1.763 1.937-3.199 3.562-3.199 3.631 0 .07 1.453 1.712 3.234 3.666 3.544 3.89 3.925 4.184 5.602 4.202 1.038 0 2.455-.588 2.542-1.055.017-.156-1.28-1.712-2.905-3.493-1.608-1.78-2.94-3.285-2.94-3.32 0-.034 1.332-1.539 2.94-3.32C22.72 6.91 24.017 5.352 24 5.214c-.087-.45-1.366-.968-2.473-1.038-.795-.034-1.21.035-1.763.312zM7.954 16.973c-2.144 2.369-3.908 4.374-3.943 4.46-.034.07.208.312.52.537.414.311.864.432 1.711.467 1.574.103 2.161-.26 4.15-2.508.864-.968 1.608-1.78 1.625-1.78s.761.812 1.643 1.798c2.023 2.248 2.559 2.576 4.132 2.49.848-.035 1.297-.156 1.712-.467.311-.225.553-.467.519-.536-.087-.26-7.92-8.819-8.058-8.801-.069 0-1.867 1.954-4.011 4.34z',
    'ansible': 'M10.617 11.473l4.686 3.695-3.102-7.662zM12 0C5.371 0 0 5.371 0 12s5.371 12 12 12 12-5.371 12-12S18.629 0 12 0zm5.797 17.305c-.011.471-.403.842-.875.83-.236 0-.416-.09-.664-.293l-6.19-5-2.079 5.203H6.191L11.438 5.44c.124-.314.427-.52.764-.506.326-.014.63.189.742.506l4.774 11.494c.045.111.08.234.08.348-.001.009-.001.009-.001.023z',
    'terraform': 'M1.44 0v7.575l6.561 3.79V3.787zm21.12 4.227l-6.561 3.791v7.574l6.56-3.787zM8.72 4.23v7.575l6.561 3.787V8.018zm0 8.405v7.575L15.28 24v-7.578z',
    'paloalto': 'm10.278 15.443 1.705 1.705-3.426 3.426-3.427-3.426 8.592-8.591-1.705-1.705 3.426-3.426 3.427 3.426-8.592 8.591zM0 12.017l3.426 3.426 8.591-8.59-3.426-3.427L0 12.017zm11.983 5.13 3.426 3.427L24 11.983l-3.426-3.426-8.591 8.59z',
    'astro': 'M8.358 20.162c-1.186-1.07-1.532-3.316-1.038-4.944.856 1.026 2.043 1.352 3.272 1.535 1.897.283 3.76.177 5.522-.678.202-.098.388-.229.608-.36.166.473.209.95.151 1.437-.14 1.185-.738 2.1-1.688 2.794-.38.277-.782.525-1.175.787-1.205.804-1.531 1.747-1.078 3.119l.044.148a3.158 3.158 0 0 1-1.407-1.188 3.31 3.31 0 0 1-.544-1.815c-.004-.32-.004-.642-.048-.958-.106-.769-.472-1.113-1.161-1.133-.707-.02-1.267.411-1.415 1.09-.012.053-.028.104-.045.165h.002zm-5.961-4.445s3.24-1.575 6.49-1.575l2.451-7.565c.092-.366.36-.614.662-.614.302 0 .57.248.662.614l2.45 7.565c3.85 0 6.491 1.575 6.491 1.575L16.088.727C15.93.285 15.663 0 15.303 0H8.697c-.36 0-.615.285-.784.727l-5.516 14.99z',
    'typescript': 'M1.125 0C.502 0 0 .502 0 1.125v21.75C0 23.498.502 24 1.125 24h21.75c.623 0 1.125-.502 1.125-1.125V1.125C24 .502 23.498 0 22.875 0zm17.363 9.75c.612 0 1.154.037 1.627.111a6.38 6.38 0 0 1 1.306.34v2.458a3.95 3.95 0 0 0-.643-.361 5.093 5.093 0 0 0-.717-.26 5.453 5.453 0 0 0-1.426-.2c-.3 0-.573.028-.819.086a2.1 2.1 0 0 0-.623.242c-.17.104-.3.229-.393.374a.888.888 0 0 0-.14.49c0 .196.053.373.156.529.104.156.252.304.443.444s.423.276.696.41c.273.135.582.274.926.416.47.197.892.407 1.266.628.374.222.695.473.963.753.268.279.472.598.614.957.142.359.214.776.214 1.253 0 .657-.125 1.21-.373 1.656a3.033 3.033 0 0 1-1.012 1.085 4.38 4.38 0 0 1-1.487.596c-.566.12-1.163.18-1.79.18a9.916 9.916 0 0 1-1.84-.164 5.544 5.544 0 0 1-1.512-.493v-2.63a5.033 5.033 0 0 0 3.237 1.2c.333 0 .624-.03.872-.09.249-.06.456-.144.623-.25.166-.108.29-.234.373-.38a1.023 1.023 0 0 0-.074-1.089 2.12 2.12 0 0 0-.537-.5 5.597 5.597 0 0 0-.807-.444 27.72 27.72 0 0 0-1.007-.436c-.918-.383-1.602-.852-2.053-1.405-.45-.553-.676-1.222-.676-2.005 0-.614.123-1.141.369-1.582.246-.441.58-.804 1.004-1.089a4.494 4.494 0 0 1 1.47-.629 7.536 7.536 0 0 1 1.77-.201zm-15.113.188h9.563v2.166H9.506v9.646H6.789v-9.646H3.375z',
    'javascript': 'M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z',
    'git': 'M23.546 10.93L13.067.452c-.604-.603-1.582-.603-2.188 0L8.708 2.627l2.76 2.76c.645-.215 1.379-.07 1.889.441.516.515.658 1.258.438 1.9l2.658 2.66c.645-.223 1.387-.078 1.9.435.721.72.721 1.884 0 2.604-.719.719-1.881.719-2.6 0-.539-.541-.674-1.337-.404-1.996L12.86 8.955v6.525c.176.086.342.203.488.348.713.721.713 1.883 0 2.6-.719.721-1.889.721-2.609 0-.719-.719-.719-1.879 0-2.598.182-.18.387-.316.605-.406V8.835c-.217-.091-.424-.222-.6-.401-.545-.545-.676-1.342-.396-2.009L7.636 3.7.45 10.881c-.6.605-.6 1.584 0 2.189l10.48 10.477c.604.604 1.582.604 2.186 0l10.43-10.43c.605-.603.605-1.582 0-2.187',
    'bash': 'M21.038,4.9l-7.577-4.498C13.009,0.134,12.505,0,12,0c-0.505,0-1.009,0.134-1.462,0.403L2.961,4.9 C2.057,5.437,1.5,6.429,1.5,7.503v8.995c0,1.073,0.557,2.066,1.462,2.603l7.577,4.497C10.991,23.866,11.495,24,12,24 c0.505,0,1.009-0.134,1.461-0.402l7.577-4.497c0.904-0.537,1.462-1.529,1.462-2.603V7.503C22.5,6.429,21.943,5.437,21.038,4.9z',
    'windows': 'M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801',
    'debian': 'M13.88 12.685c-.4 0 .08.2.601.28.14-.1.27-.22.39-.33a3.001 3.001 0 01-.99.05m2.14-.53c.23-.33.4-.69.47-1.06-.06.27-.2.5-.33.73-.75.47-.07-.27 0-.56-.8 1.01-.11.6-.14.89m.781-2.05c.05-.721-.14-.501-.2-.221.07.04.13.5.2.22M12.38.31c.2.04.45.07.42.12.23-.05.28-.1-.43-.12m.43.12l-.15.03.14-.01V.43m6.633 9.944c.02.64-.2.95-.38 1.5l-.35.181c-.28.54.03.35-.17.78-.44.39-1.34 1.22-1.62 1.301-.201 0 .14-.25.19-.34-.591.4-.481.6-1.371.85l-.03-.06c-2.221 1.04-5.303-1.02-5.253-3.842-.03.17-.07.13-.12.2a3.551 3.552 0 012.001-3.501 3.361 3.362 0 013.732.48 3.341 3.342 0 00-2.721-1.3c-1.18.01-2.281.76-2.651 1.57-.6.38-.67 1.47-.93 1.661-.361 2.601.66 3.722 2.38 5.042.27.19.08.21.12.35a4.702 4.702 0 01-1.53-1.16c.23.33.47.66.8.91-.55-.18-1.27-1.3-1.48-1.35.93 1.66 3.78 2.921 5.261 2.3a6.203 6.203 0 01-2.33-.28c-.33-.16-.77-.51-.7-.57a5.802 5.803 0 005.902-.84c.44-.35.93-.94 1.07-.95-.2.32.04.16-.12.44.44-.72-.2-.3.46-1.24l.24.33c-.09-.6.74-1.321.66-2.262.19-.3.2.3 0 .97.29-.74.08-.85.15-1.46.08.2.18.42.23.63-.18-.7.2-1.2.28-1.6-.09-.05-.28.3-.32-.53 0-.37.1-.2.14-.28-.08-.05-.26-.32-.38-.861.08-.13.22.33.34.34-.08-.42-.2-.75-.2-1.08-.34-.68-.12.1-.4-.3-.34-1.091.3-.25.34-.74.54.77.84 1.96.981 2.46-.1-.6-.28-1.2-.49-1.76.16.07-.26-1.241.21-.37A7.823 7.824 0 0017.702 1.6c.18.17.42.39.33.42-.75-.45-.62-.48-.73-.67-.61-.25-.65.02-1.06 0C15.082.73 14.862.8 13.8.4l.05.23c-.77-.25-.9.1-1.73 0-.05-.04.27-.14.53-.18-.741.1-.701-.14-1.431.03.17-.13.36-.21.55-.32-.6.04-1.44.35-1.18.07C9.6.68 7.847 1.3 6.867 2.22L6.838 2c-.45.54-1.96 1.611-2.08 2.311l-.131.03c-.23.4-.38.85-.57 1.261-.3.52-.45.2-.4.28-.6 1.22-.9 2.251-1.16 3.102.18.27 0 1.65.07 2.76-.3 5.463 3.84 10.776 8.363 12.006.67.23 1.65.23 2.49.25-.99-.28-1.12-.15-2.08-.49-.7-.32-.85-.7-1.34-1.13l.2.35c-.971-.34-.57-.42-1.361-.67l.21-.27c-.31-.03-.83-.53-.97-.81l-.34.01c-.41-.501-.63-.871-.61-1.161l-.111.2c-.13-.21-1.52-1.901-.8-1.511-.13-.12-.31-.2-.5-.55l.14-.17c-.35-.44-.64-1.02-.62-1.2.2.24.32.3.45.33-.88-2.172-.93-.12-1.601-2.202l.15-.02c-.1-.16-.18-.34-.26-.51l.06-.6c-.63-.74-.18-3.102-.09-4.402.07-.54.53-1.1.88-1.981l-.21-.04c.4-.71 2.341-2.872 3.241-2.761.43-.55-.09 0-.18-.14.96-.991 1.26-.7 1.901-.88.7-.401-.6.16-.27-.151 1.2-.3.85-.7 2.421-.85.16.1-.39.14-.52.26 1-.49 3.151-.37 4.562.27 1.63.77 3.461 3.011 3.531 5.132l.08.02c-.04.85.13 1.821-.17 2.711l.2-.42',
    'ubuntu': 'M17.61.455a3.41 3.41 0 0 0-3.41 3.41 3.41 3.41 0 0 0 3.41 3.41 3.41 3.41 0 0 0 3.41-3.41 3.41 3.41 0 0 0-3.41-3.41zM12.92.8C8.923.777 5.137 2.941 3.148 6.451a4.5 4.5 0 0 1 .26-.007 4.92 4.92 0 0 1 2.585.737A8.316 8.316 0 0 1 12.688 3.6 4.944 4.944 0 0 1 13.723.834 11.008 11.008 0 0 0 12.92.8zm9.226 4.994a4.915 4.915 0 0 1-1.918 2.246 8.36 8.36 0 0 1-.273 8.303 4.89 4.89 0 0 1 1.632 2.54 11.156 11.156 0 0 0 .559-13.089zM3.41 7.932A3.41 3.41 0 0 0 0 11.342a3.41 3.41 0 0 0 3.41 3.409 3.41 3.41 0 0 0 3.41-3.41 3.41 3.41 0 0 0-3.41-3.41zm2.027 7.866a4.908 4.908 0 0 1-2.915.358 11.1 11.1 0 0 0 7.991 6.698 11.234 11.234 0 0 0 2.422.249 4.879 4.879 0 0 1-.999-2.85 8.484 8.484 0 0 1-.836-.136 8.304 8.304 0 0 1-5.663-4.32zm11.405.928a3.41 3.41 0 0 0-3.41 3.41 3.41 3.41 0 0 0 3.41 3.41 3.41 3.41 0 0 0 3.41-3.41 3.41 3.41 0 0 0-3.41-3.41z',
    'vmware': 'M.5 10.1a.505.505 0 00-.197.048.497.497 0 00-.25.68l1.138 2.475c.179.38.38.592.721.592.342 0 .542-.22.72-.592l1.003-2.186a.144.144 0 01.144-.092.16.16 0 01.157.16v2.118a.535.535 0 101.066 0v-1.73a.531.531 0 01.566-.552.52.52 0 01.541.551v1.73a.531.531 0 00.53.593.539.539 0 00.535-.592v-1.73a.531.531 0 01.564-.552.52.52 0 01.543.551v1.73a.531.531 0 00.528.593.535.535 0 00.535-.592v-1.969a1.234 1.234 0 00-1.283-1.23 1.647 1.647 0 00-1.14.486 1.26 1.26 0 00-1.095-.483 1.807 1.807 0 00-1.074.483 1.287 1.287 0 00-.961-.483 1.177 1.177 0 00-1.158.786l-.729 1.716-.933-2.203.011-.004A.505.505 0 00.5 10.1z',
    'markdown': 'M22.27 19.385H1.73A1.73 1.73 0 010 17.655V6.345a1.73 1.73 0 011.73-1.73h20.54A1.73 1.73 0 0124 6.345v11.308a1.73 1.73 0 01-1.73 1.731zM5.769 15.923v-4.5l2.308 2.885 2.307-2.885v4.5h2.308V8.078h-2.308l-2.307 2.885-2.308-2.885H3.46v7.847zM21.232 12h-2.309V8.077h-2.307V12h-2.308l3.461 4.039z',
    'elasticsearch': 'M13.394 0C8.683 0 4.609 2.716 2.644 6.667h15.641a4.77 4.77 0 0 0 3.073-1.11c.446-.375.864-.785 1.247-1.243l.001-.002A11.974 11.974 0 0 0 13.394 0zM1.804 8.889a12.009 12.009 0 0 0 0 6.222h14.7a3.111 3.111 0 1 0 0-6.222zm.84 8.444C4.61 21.283 8.684 24 13.395 24c3.701 0 7.011-1.677 9.212-4.312l-.001-.002a9.958 9.958 0 0 0-1.247-1.243 4.77 4.77 0 0 0-3.073-1.11z',
    'kibana': 'M2.625 0v21.591L21.375 0zm10.864 12.47L3.477 24h17.522a18.755 18.755 0 0 0-7.51-11.53z',
    'logstash': 'M13.745 24h8.291v-9.164h-8.29zm-2.618 0h.437v-9.164h-9.6A9.163 9.163 0 0011.127 24m.438-9.164h-9.6V0h.873a8.727 8.727 0 018.727 8.727z',
    'python': 'M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09z',
    'traefik': 'M12 .023C5.372.023 0 5.395 0 12.024c0 6.628 5.372 12 12 12s12-5.372 12-12c0-6.629-5.372-12-12-12zm0 21.6c-5.304 0-9.6-4.296-9.6-9.6s4.296-9.6 9.6-9.6 9.6 4.296 9.6 9.6-4.296 9.6-9.6 9.6z',
    'activedirectory': 'M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801',
    'frontend': 'M1.5 0h21l-1.91 21.563L11.977 24l-8.565-2.438L1.5 0zm17.09 4.413L5.41 4.41l.213 2.622 10.125.002-.255 2.716h-6.64l.24 2.573h6.182l-.366 3.523-2.91.804-2.956-.81-.188-2.11h-2.61l.29 3.855L12 19.288l5.373-1.53L18.59 4.414z',
    'monitoring': 'M12 0C5.373 0 0 5.372 0 12c0 6.627 5.373 12 12 12s12-5.373 12-12c0-6.628-5.373-12-12-12zm0 22.46c-1.885 0-3.414-1.26-3.414-2.814h6.828c0 1.553-1.528 2.813-3.414 2.813zm5.64-3.745H6.36v-2.046h11.28v2.046zm-.04-3.098H6.391c-.037-.043-.075-.086-.111-.13-1.155-1.401-1.427-2.133-1.69-2.879-.005-.025 1.4.287 2.395.511 0 0 .513.119 1.262.255-.72-.843-1.147-1.915-1.147-3.01 0-2.406 1.845-4.508 1.18-6.207.648.053 1.34 1.367 1.387 3.422.689-.951.977-2.69.977-3.755 0-1.103.727-2.385 1.454-2.429-.648 1.069.168 1.984.894 4.256.272.854.237 2.29.447 3.201.07-1.892.395-4.652 1.595-5.605-.529 1.2.079 2.702.494 3.424.671 1.164 1.078 2.047 1.078 3.716a4.642 4.642 0 01-1.11 2.996c.792-.149 1.34-.283 1.34-.283l2.573-.502s-.374 1.538-1.81 3.019z',
    'observability': 'M12 0C5.373 0 0 5.372 0 12c0 6.627 5.373 12 12 12s12-5.373 12-12c0-6.628-5.373-12-12-12zm0 22.46c-1.885 0-3.414-1.26-3.414-2.814h6.828c0 1.553-1.528 2.813-3.414 2.813zm5.64-3.745H6.36v-2.046h11.28v2.046zm-.04-3.098H6.391c-.037-.043-.075-.086-.111-.13-1.155-1.401-1.427-2.133-1.69-2.879-.005-.025 1.4.287 2.395.511 0 0 .513.119 1.262.255-.72-.843-1.147-1.915-1.147-3.01 0-2.406 1.845-4.508 1.18-6.207.648.053 1.34 1.367 1.387 3.422.689-.951.977-2.69.977-3.755 0-1.103.727-2.385 1.454-2.429-.648 1.069.168 1.984.894 4.256.272.854.237 2.29.447 3.201.07-1.892.395-4.652 1.595-5.605-.529 1.2.079 2.702.494 3.424.671 1.164 1.078 2.047 1.078 3.716a4.642 4.642 0 01-1.11 2.996c.792-.149 1.34-.283 1.34-.283l2.573-.502s-.374 1.538-1.81 3.019z',
    'dashboard': 'M12 0C5.373 0 0 5.372 0 12c0 6.627 5.373 12 12 12s12-5.373 12-12c0-6.628-5.373-12-12-12zm0 22.46c-1.885 0-3.414-1.26-3.414-2.814h6.828c0 1.553-1.528 2.813-3.414 2.813zm5.64-3.745H6.36v-2.046h11.28v2.046zm-.04-3.098H6.391c-.037-.043-.075-.086-.111-.13-1.155-1.401-1.427-2.133-1.69-2.879-.005-.025 1.4.287 2.395.511 0 0 .513.119 1.262.255-.72-.843-1.147-1.915-1.147-3.01 0-2.406 1.845-4.508 1.18-6.207.648.053 1.34 1.367 1.387 3.422.689-.951.977-2.69.977-3.755 0-1.103.727-2.385 1.454-2.429-.648 1.069.168 1.984.894 4.256.272.854.237 2.29.447 3.201.07-1.892.395-4.652 1.595-5.605-.529 1.2.079 2.702.494 3.424.671 1.164 1.078 2.047 1.078 3.716a4.642 4.642 0 01-1.11 2.996c.792-.149 1.34-.283 1.34-.283l2.573-.502s-.374 1.538-1.81 3.019z',
    'documentation': 'M22.27 19.385H1.73A1.73 1.73 0 010 17.655V6.345a1.73 1.73 0 011.73-1.73h20.54A1.73 1.73 0 0124 6.345v11.308a1.73 1.73 0 01-1.73 1.731zM5.769 15.923v-4.5l2.308 2.885 2.307-2.885v4.5h2.308V8.078h-2.308l-2.307 2.885-2.308-2.885H3.46v7.847zM21.232 12h-2.309V8.077h-2.307V12h-2.308l3.461 4.039z',
    'architecture': 'M1.44 0v7.575l6.561 3.79V3.787zm21.12 4.227l-6.561 3.791v7.574l6.56-3.787zM8.72 4.23v7.575l6.561 3.787V8.018zm0 8.405v7.575L15.28 24v-7.578z',
    'firewall': 'm10.278 15.443 1.705 1.705-3.426 3.426-3.427-3.426 8.592-8.591-1.705-1.705 3.426-3.426 3.427 3.426-8.592 8.591zM0 12.017l3.426 3.426 8.591-8.59-3.426-3.427L0 12.017zm11.983 5.13 3.426 3.427L24 11.983l-3.426-3.426-8.591 8.59z',
    'security': 'm10.278 15.443 1.705 1.705-3.426 3.426-3.427-3.426 8.592-8.591-1.705-1.705 3.426-3.426 3.427 3.426-8.592 8.591zM0 12.017l3.426 3.426 8.591-8.59-3.426-3.427L0 12.017zm11.983 5.13 3.426 3.427L24 11.983l-3.426-3.426-8.591 8.59z',
    'virtualisation': 'M4.928 1.825c-1.09.553-1.09.64-.07 1.78 5.655 6.295 7.004 7.782 7.107 7.782.139.017 7.971-8.542 8.058-8.801.034-.07-.208-.312-.519-.536-.415-.312-.864-.433-1.712-.467-1.59-.104-2.144.242-4.115 2.455-.899 1.003-1.66 1.833-1.66 1.833-.017 0-.76-.813-1.642-1.798S8.473 2.1 8.127 1.91c-.796-.45-2.421-.484-3.2-.086zM1.297 4.367C.45 4.695 0 5.007 0 5.248c0 .121 1.331 1.678 2.94 3.459 1.625 1.78 2.939 3.268 2.939 3.302 0 .035-1.331 1.522-2.94 3.303C1.314 17.11.017 18.683.035 18.822c.086.467 1.504 1.055 2.541 1.055 1.678-.018 2.058-.312 5.603-4.202 1.78-1.954 3.233-3.614 3.233-3.666 0-.069-1.435-1.694-3.199-3.63-2.3-2.508-3.423-3.632-3.96-3.874-.812-.398-2.126-.467-2.956-.138zm18.467.12c-.502.26-1.764 1.505-3.943 3.891-1.763 1.937-3.199 3.562-3.199 3.631 0 .07 1.453 1.712 3.234 3.666 3.544 3.89 3.925 4.184 5.602 4.202 1.038 0 2.455-.588 2.542-1.055.017-.156-1.28-1.712-2.905-3.493-1.608-1.78-2.94-3.285-2.94-3.32 0-.034 1.332-1.539 2.94-3.32C22.72 6.91 24.017 5.352 24 5.214c-.087-.45-1.366-.968-2.473-1.038-.795-.034-1.21.035-1.763.312zM7.954 16.973c-2.144 2.369-3.908 4.374-3.943 4.46-.034.07.208.312.52.537.414.311.864.432 1.711.467 1.574.103 2.161-.26 4.15-2.508.864-.968 1.608-1.78 1.625-1.78s.761.812 1.643 1.798c2.023 2.248 2.559 2.576 4.132 2.49.848-.035 1.297-.156 1.712-.467.311-.225.553-.467.519-.536-.087-.26-7.92-8.819-8.058-8.801-.069 0-1.867 1.954-4.011 4.34z',
    // Additional tags - aliases and missing tags
    'infrastructure': 'M1.44 0v7.575l6.561 3.79V3.787zm21.12 4.227l-6.561 3.791v7.574l6.56-3.787zM8.72 4.23v7.575l6.561 3.787V8.018zm0 8.405v7.575L15.28 24v-7.578z',
    'victorialogs': 'M12 0C5.373 0 0 5.372 0 12c0 6.627 5.373 12 12 12s12-5.373 12-12c0-6.628-5.373-12-12-12zm0 22.46c-1.885 0-3.414-1.26-3.414-2.814h6.828c0 1.553-1.528 2.813-3.414 2.813zm5.64-3.745H6.36v-2.046h11.28v2.046zm-.04-3.098H6.391c-.037-.043-.075-.086-.111-.13-1.155-1.401-1.427-2.133-1.69-2.879-.005-.025 1.4.287 2.395.511 0 0 .513.119 1.262.255-.72-.843-1.147-1.915-1.147-3.01 0-2.406 1.845-4.508 1.18-6.207.648.053 1.34 1.367 1.387 3.422.689-.951.977-2.69.977-3.755 0-1.103.727-2.385 1.454-2.429-.648 1.069.168 1.984.894 4.256.272.854.237 2.29.447 3.201.07-1.892.395-4.652 1.595-5.605-.529 1.2.079 2.702.494 3.424.671 1.164 1.078 2.047 1.078 3.716a4.642 4.642 0 01-1.11 2.996c.792-.149 1.34-.283 1.34-.283l2.573-.502s-.374 1.538-1.81 3.019z',
    'devops': 'M13.983 11.078h2.119a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.119a.185.185 0 00-.185.185v1.888c0 .102.083.185.185.185m-2.954-5.43h2.118a.186.186 0 00.186-.186V3.574a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m0 2.716h2.118a.187.187 0 00.186-.186V6.29a.186.186 0 00-.186-.185h-2.118a.185.185 0 00-.185.185v1.887c0 .102.082.185.185.186m-2.93 0h2.12a.186.186 0 00.184-.186V6.29a.185.185 0 00-.185-.185H8.1a.185.185 0 00-.185.185v1.887c0 .102.083.185.185.186m-2.964 0h2.119a.186.186 0 00.185-.186V6.29a.185.185 0 00-.185-.185H5.136a.186.186 0 00-.186.185v1.887c0 .102.084.185.186.186m5.893 2.715h2.118a.186.186 0 00.186-.185V9.006a.186.186 0 00-.186-.186h-2.118a.185.185 0 00-.185.185v1.888c0 .102.082.185.185.185m-2.93 0h2.12a.185.185 0 00.184-.185V9.006a.185.185 0 00-.184-.186h-2.12a.185.185 0 00-.184.185v1.888c0 .102.083.185.185.185m-2.964 0h2.119a.185.185 0 00.185-.185V9.006a.185.185 0 00-.184-.186h-2.12a.186.186 0 00-.186.186v1.887c0 .102.084.185.186.185m-2.92 0h2.12a.185.185 0 00.184-.185V9.006a.185.185 0 00-.184-.186h-2.12a.185.185 0 00-.184.185v1.888c0 .102.082.185.185.185M23.763 9.89c-.065-.051-.672-.51-1.954-.51-.338.001-.676.03-1.01.087-.248-1.7-1.653-2.53-1.716-2.566l-.344-.199-.226.327c-.284.438-.49.922-.612 1.43-.23.97-.09 1.882.403 2.661-.595.332-1.55.413-1.744.42H.751a.751.751 0 00-.75.748 11.376 11.376 0 00.692 4.062c.545 1.428 1.355 2.48 2.41 3.124 1.18.723 3.1 1.137 5.275 1.137.983.003 1.963-.086 2.93-.266a12.248 12.248 0 003.823-1.389c.98-.567 1.86-1.288 2.61-2.136 1.252-1.418 1.998-2.997 2.553-4.4h.221c1.372 0 2.215-.549 2.68-1.009.309-.293.55-.65.707-1.046l.098-.288Z'
};

// Technology colors (Simple Icons brand colors)
const TECH_COLORS = {
    'grafana': '#F46800',
    'prometheus': '#E6522C',
    'docker': '#2496ED',
    'kubernetes': '#326CE5',
    'proxmox': '#E57000',
    'paloalto': '#FA582D',
    'nginx': '#009639',
    'linux': '#FCC624',
    'windows': '#0078D4',
    'debian': '#A81D33',
    'ubuntu': '#E95420',
    'astro': '#FF5D01',
    'typescript': '#3178C6',
    'javascript': '#F7DF1E',
    'python': '#3776AB',
    'git': '#F05032',
    'ansible': '#EE0000',
    'terraform': '#844FBA',
    'elasticsearch': '#005571',
    'kibana': '#E8478B',
    'logstash': '#005571',
    'bash': '#4EAA25',
    'vmware': '#607078',
    'markdown': '#000000',
    'traefik': '#24A1C1',
    'activedirectory': '#0078D4',
    'victorialogs': '#621773'
};

// Theme tags to filter out (not technologies)
const THEME_TAGS = [
    'monitoring', 'observability', 'dashboard', 'security', 'infrastructure',
    'architecture', 'documentation', 'firewall', 'virtualisation', 'devops',
    'frontend', 'backend', 'network', 'backup', 'llm', 'webfront'
];

class DocModalSystem {
    constructor() {
        this.modal = document.getElementById('doc-modal');
        this.overlay = this.modal?.querySelector('.doc-modal-overlay');
        this.closeButtons = this.modal?.querySelectorAll('[data-modal-close]');
        this.prevButton = document.getElementById('doc-modal-prev');
        this.nextButton = document.getElementById('doc-modal-next');
        this.progressFill = this.modal?.querySelector('.doc-progress-fill');
        this.contentEl = this.modal?.querySelector('.doc-modal-content');
        this.tocList = document.getElementById('doc-toc-list');

        this.currentDocIndex = -1;
        this.allDocs = [];
        this.tocObserver = null;
        this.headingIdCounter = 0;

        this.init();
    }

    init() {
        if (!this.modal) {
            console.warn('Doc modal not found in DOM');
            return;
        }

        // Récupérer toutes les documentations disponibles
        this.loadDocsList();

        // Attacher les event listeners
        this.attachEventListeners();

        // Initialiser la progress bar
        this.initProgressBar();

        // Gérer le hash dans l'URL pour deep linking
        this.handleUrlHash();

        console.log('✓ Documentation modal system initialized');
    }

    initProgressBar() {
        if (!this.contentEl || !this.progressFill) return;

        this.contentEl.addEventListener('scroll', () => {
            const scrollTop = this.contentEl.scrollTop;
            const scrollHeight = this.contentEl.scrollHeight - this.contentEl.clientHeight;

            if (scrollHeight > 0) {
                const progress = (scrollTop / scrollHeight) * 100;
                this.progressFill.style.width = `${Math.min(100, Math.max(0, progress))}%`;
            }
        }, { passive: true });
    }

    resetProgressBar() {
        if (this.progressFill) {
            this.progressFill.style.width = '0%';
        }
    }

    loadDocsList() {
        const docCards = document.querySelectorAll('.doc-list-card');
        this.allDocs = Array.from(docCards).map(card => ({
            slug: card.dataset.docSlug,
            element: card,
            title: card.querySelector('.doc-card-title')?.textContent || '',
            description: card.querySelector('.doc-card-description')?.textContent || '',
            category: card.querySelector('.doc-card-category')?.textContent || '',
            date: card.querySelector('.doc-card-date')?.textContent || '',
            tags: Array.from(card.querySelectorAll('.doc-card-tag')).map(tag => tag.textContent)
        }));

        console.log(`✓ Loaded ${this.allDocs.length} documentation cards`);
    }

    attachEventListeners() {
        // Fermeture du modal
        this.closeButtons?.forEach(btn => {
            btn.addEventListener('click', () => this.closeModal());
        });

        // Navigation avec les flèches
        document.addEventListener('keydown', (e) => {
            if (this.modal?.dataset.modalState === 'open') {
                if (e.key === 'ArrowLeft') this.navigatePrevious();
                if (e.key === 'ArrowRight') this.navigateNext();
            }
        });

        // Boutons de navigation
        this.prevButton?.addEventListener('click', () => this.navigatePrevious());
        this.nextButton?.addEventListener('click', () => this.navigateNext());

        // Click sur les cards de documentation
        this.allDocs.forEach((doc, index) => {
            doc.element.addEventListener('click', () => {
                this.openModal(doc.slug, index);
            });

            // Ajouter un style de hover
            doc.element.style.cursor = 'pointer';
        });
    }

    async openModal(slug, index) {
        this.currentDocIndex = index;

        // Réinitialiser la progress bar
        this.resetProgressBar();

        // Mettre à jour l'URL
        window.location.hash = `doc-${slug}`;

        // Charger le contenu
        await this.loadDocContent(slug);

        // Afficher le modal
        this.modal.dataset.modalState = 'open';
        document.body.style.overflow = 'hidden';

        // Mettre à jour les boutons de navigation
        this.updateNavigationButtons();
    }

    closeModal() {
        this.modal.dataset.modalState = 'closed';
        document.body.style.overflow = '';

        // Réinitialiser la progress bar
        this.resetProgressBar();

        // Nettoyer la TOC
        this.cleanupTOC();

        // Nettoyer le hash
        history.pushState('', document.title, window.location.pathname + window.location.search);
    }

    async loadDocContent(slug) {
        try {
            // Fetch le contenu depuis l'API JSON
            const response = await fetch(`/api/docs/${slug}.json`);

            if (!response.ok) {
                throw new Error(`Failed to load doc: ${slug}`);
            }

            const docData = await response.json();
            const markdownContent = docData.content;

            // Convertir le Markdown en HTML
            const htmlContent = this.convertMarkdownToHtml(markdownContent);

            // Calculer les stats
            const wordCount = markdownContent.split(/\s+/).length;
            const readingTime = Math.ceil(wordCount / 200); // ~200 mots par minute

            // Mettre à jour le modal avec les données de l'API
            this.updateModalContent({
                title: docData.title,
                description: docData.description,
                categoryDisplay: docData.category,
                date: new Date(docData.date).toLocaleDateString('fr-FR', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                }),
                tags: docData.tags,
                htmlContent: htmlContent,
                wordCount: wordCount,
                readingTime: readingTime
            });

        } catch (error) {
            console.error('Error loading documentation:', error);
            this.showError();
        }
    }

    convertMarkdownToHtml(markdown) {
        // Enlever le frontmatter YAML
        let html = markdown.replace(/^---[\s\S]*?---\n/, '');

        // Code blocks - Terminal style avec bouton copier
        // Regex amélioré: ```lang:filename ou ```lang
        html = html.replace(/```(\w+)?(?::(.+?))?\n([\s\S]*?)```/g, (_, lang, filename, code) => {
            const language = lang || 'text';
            const escapedCode = this.escapeHtml(code.trim());
            const codeId = `code-${Date.now()}-${Math.random().toString(36).slice(2, 11)}`;

            return `<div class="code-block" data-code-id="${codeId}">
                <div class="code-header">
                    <div class="code-header-left">
                        <span class="dot red"></span>
                        <span class="dot yellow"></span>
                        <span class="dot green"></span>
                        <span class="code-lang">${language}</span>
                        ${filename ? `<span class="code-filename">${filename}</span>` : ''}
                    </div>
                    <button class="code-copy-btn" data-code-target="${codeId}" aria-label="Copier le code">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                        <span class="copy-text">Copier</span>
                    </button>
                </div>
                <pre><code data-code-content="${codeId}">${escapedCode}</code></pre>
            </div>`;
        });

        // Horizontal rules (avant headings pour éviter confusion)
        html = html.replace(/^---$/gm, '<hr class="doc-divider">');

        // Blockquotes
        html = html.replace(/^>\s*(.*)$/gm, '<blockquote>$1</blockquote>');
        html = html.replace(/<\/blockquote>\n<blockquote>/g, '<br>');

        // Headings (H4 ajouté)
        html = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');
        html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');
        html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');
        html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');

        // Bold
        html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

        // Appliquer les couleurs aux labels
        html = this.applyLabelColors(html);

        // Italic
        html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');

        // Code inline (après les code blocks pour éviter les conflits)
        html = html.replace(/`([^`]+)`/g, '<code>$1</code>');

        // Links
        html = html.replace(/\[([^\]]+)\]\(([^\)]+)\)/g, '<a href="$2" target="_blank">$1</a>');

        // Listes à puces
        html = html.replace(/^\- (.*$)/gim, '<li>$1</li>');

        // Listes ordonnées
        html = html.replace(/^\d+\.\s+(.*$)/gim, '<li class="ordered">$1</li>');

        // Wrapper les listes
        html = this.wrapLists(html);

        // Paragraphs
        html = html.split('\n\n').map(para => {
            para = para.trim();
            if (para && !para.startsWith('<') && !para.match(/^<[a-z]/i)) {
                return `<p>${para}</p>`;
            }
            return para;
        }).join('\n');

        return html;
    }

    applyLabelColors(html) {
        const LABEL_COLORS = {
            'symptôme': '#F5A623', 'symptome': '#F5A623',
            'root cause': '#F5A623', 'cause': '#F5A623',
            'solution': '#00ff88', 'résolution': '#00ff88',
            'resolution': '#00ff88', 'correction': '#00ff88',
            'diagnostic': '#00ffff', 'configuration': '#00ffff',
            'important': '#ff0080', 'attention': '#ff0080',
            'note': 'rgba(255,255,255,0.6)'
        };

        return html.replace(/<strong>([^<]+)<\/strong>\s*:/g, (match, label) => {
            const normalized = label.toLowerCase().trim();
            const color = LABEL_COLORS[normalized];
            if (color) {
                return `<strong class="doc-label" style="color: ${color}">${label}</strong> :`;
            }
            return match;
        });
    }

    wrapLists(html) {
        const lines = html.split('\n');
        const result = [];
        let inList = false;
        let listType = null;

        lines.forEach(line => {
            if (line.includes('<li class="ordered">')) {
                if (!inList || listType !== 'ol') {
                    if (inList) result.push(listType === 'ul' ? '</ul>' : '</ol>');
                    result.push('<ol>');
                    inList = true;
                    listType = 'ol';
                }
                result.push(line.replace(' class="ordered"', ''));
            } else if (line.includes('<li>')) {
                if (!inList || listType !== 'ul') {
                    if (inList) result.push(listType === 'ul' ? '</ul>' : '</ol>');
                    result.push('<ul>');
                    inList = true;
                    listType = 'ul';
                }
                result.push(line);
            } else {
                if (inList) {
                    result.push(listType === 'ul' ? '</ul>' : '</ol>');
                    inList = false;
                    listType = null;
                }
                result.push(line);
            }
        });

        if (inList) {
            result.push(listType === 'ul' ? '</ul>' : '</ol>');
        }

        return result.join('\n');
    }

    escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    getLanguageLabel(lang) {
        const labels = {
            'bash': 'Terminal',
            'sh': 'Shell',
            'zsh': 'Terminal',
            'powershell': 'PowerShell',
            'ps1': 'PowerShell',
            'cmd': 'Command Prompt',
            'yaml': 'YAML',
            'yml': 'YAML',
            'json': 'JSON',
            'javascript': 'JavaScript',
            'js': 'JavaScript',
            'typescript': 'TypeScript',
            'ts': 'TypeScript',
            'python': 'Python',
            'py': 'Python',
            'html': 'HTML',
            'css': 'CSS',
            'scss': 'SCSS',
            'nginx': 'Nginx',
            'dockerfile': 'Dockerfile',
            'docker': 'Docker',
            'sql': 'SQL',
            'text': 'Texte'
        };
        return labels[lang.toLowerCase()] || lang.toUpperCase();
    }

    initCodeCopyButtons() {
        const copyButtons = this.modal.querySelectorAll('.code-copy-btn');
        copyButtons.forEach(btn => {
            btn.addEventListener('click', async (e) => {
                e.preventDefault();
                const codeId = btn.dataset.codeTarget;
                const codeEl = this.modal.querySelector(`[data-code-content="${codeId}"]`);

                if (codeEl) {
                    try {
                        await navigator.clipboard.writeText(codeEl.textContent);

                        // Feedback visuel
                        btn.classList.add('copied');
                        const textSpan = btn.querySelector('.copy-text');
                        const originalText = textSpan.textContent;
                        textSpan.textContent = 'Copié ✓';

                        setTimeout(() => {
                            btn.classList.remove('copied');
                            textSpan.textContent = originalText;
                        }, 2000);
                    } catch (err) {
                        console.error('Failed to copy code:', err);
                    }
                }
            });
        });
    }

    generateTOC() {
        if (!this.tocList) return;

        const bodyEl = this.modal.querySelector('#doc-modal-body');
        if (!bodyEl) return;

        // Réinitialiser le compteur d'IDs
        this.headingIdCounter = 0;

        // Trouver tous les H2 et H3
        const headings = bodyEl.querySelectorAll('h2, h3');

        if (headings.length === 0) {
            this.tocList.innerHTML = '<li><span style="color: rgba(255,255,255,0.3); font-size: 0.7rem; padding: 0.5rem 1rem;">Aucune section</span></li>';
            return;
        }

        // Générer les IDs uniques et construire la TOC
        const tocItems = [];
        headings.forEach((heading) => {
            // Générer un ID unique basé sur le texte
            const text = heading.textContent.trim();
            const id = this.slugify(text) + '-' + (++this.headingIdCounter);
            heading.id = id;

            const level = heading.tagName.toLowerCase();
            tocItems.push(`
                <li>
                    <a href="#${id}" class="toc-${level}" data-toc-target="${id}">${text}</a>
                </li>
            `);
        });

        this.tocList.innerHTML = tocItems.join('');

        // Attacher les event listeners pour le smooth scroll
        this.tocList.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.dataset.tocTarget;
                const targetEl = document.getElementById(targetId);
                if (targetEl && this.contentEl) {
                    // Calculer la position relative au container scrollable
                    const containerRect = this.contentEl.getBoundingClientRect();
                    const targetRect = targetEl.getBoundingClientRect();
                    const scrollTop = this.contentEl.scrollTop + (targetRect.top - containerRect.top) - 20;

                    this.contentEl.scrollTo({
                        top: scrollTop,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Initialiser l'IntersectionObserver pour le highlight
        this.initTOCObserver();
    }

    slugify(text) {
        return text
            .toLowerCase()
            .normalize('NFD')
            .replace(/[\u0300-\u036f]/g, '') // Supprimer les accents
            .replace(/[^a-z0-9\s-]/g, '')
            .replace(/\s+/g, '-')
            .replace(/-+/g, '-')
            .substring(0, 50);
    }

    initTOCObserver() {
        // Nettoyer l'observer précédent
        if (this.tocObserver) {
            this.tocObserver.disconnect();
        }

        const bodyEl = this.modal.querySelector('#doc-modal-body');
        if (!bodyEl || !this.contentEl) return;

        const headings = bodyEl.querySelectorAll('h2, h3');
        if (headings.length === 0) return;

        // Garder track du dernier heading actif
        this.lastActiveHeadingId = null;

        // Options de l'observer - zone de détection ajustée
        const options = {
            root: this.contentEl,
            rootMargin: '-20% 0px -60% 0px',
            threshold: [0, 0.25, 0.5]
        };

        this.tocObserver = new IntersectionObserver((entries) => {
            // Trouver le heading le plus haut visible
            let topMostVisible = null;
            let topMostPosition = Infinity;

            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const rect = entry.boundingClientRect;
                    if (rect.top < topMostPosition && rect.top >= 0) {
                        topMostPosition = rect.top;
                        topMostVisible = entry.target;
                    }
                }
            });

            // Si on a trouvé un heading visible et qu'il est différent du précédent
            if (topMostVisible && topMostVisible.id !== this.lastActiveHeadingId) {
                this.lastActiveHeadingId = topMostVisible.id;
                this.updateTOCActive(topMostVisible.id);
            }
        }, options);

        // Observer tous les headings
        headings.forEach(heading => {
            this.tocObserver.observe(heading);
        });

        // Activer le premier heading par défaut
        if (headings.length > 0 && headings[0].id) {
            this.updateTOCActive(headings[0].id);
        }
    }

    updateTOCActive(id) {
        if (!this.tocList) return;

        // Retirer la classe active de tous les liens
        this.tocList.querySelectorAll('a').forEach(a => {
            a.classList.remove('active');
        });

        // Ajouter la classe active au lien correspondant
        const activeLink = this.tocList.querySelector(`a[data-toc-target="${id}"]`);
        if (activeLink) {
            activeLink.classList.add('active');
            // Scroll la TOC pour garder l'élément visible
            activeLink.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
        }
    }

    cleanupTOC() {
        if (this.tocObserver) {
            this.tocObserver.disconnect();
            this.tocObserver = null;
        }
        if (this.tocList) {
            this.tocList.innerHTML = '';
        }
    }

    updateModalContent(docData) {
        // Titre et description (nouveau sélecteur pour layout terminal)
        const titleEl = this.modal.querySelector('.doc-modal-title-text');
        const descEl = this.modal.querySelector('.doc-modal-description');
        const categoryEl = this.modal.querySelector('.doc-modal-category');
        const dateEl = this.modal.querySelector('.doc-modal-date');

        if (titleEl) titleEl.textContent = docData.title;
        if (descEl) descEl.textContent = docData.description;
        if (categoryEl) categoryEl.textContent = docData.categoryDisplay;
        if (dateEl) dateEl.textContent = docData.date;

        // Tags - Display technology icons only (filter out themes)
        const tagsContainer = this.modal.querySelector('#doc-modal-tags');
        if (tagsContainer && docData.tags && docData.tags.length > 0) {
            // Filter to keep only technology tags (not themes)
            const techTags = docData.tags.filter(tag => {
                const normalized = tag.toLowerCase().replace(/[\s-]+/g, '');
                return !THEME_TAGS.includes(normalized);
            });

            tagsContainer.innerHTML = techTags.map(tag => {
                const normalizedTag = tag.toLowerCase().replace(/[\s-]+/g, '');
                const iconPath = TAG_ICON_MAPPING[normalizedTag];
                const color = TECH_COLORS[normalizedTag] || 'rgba(255, 255, 255, 0.7)';
                if (iconPath) {
                    return `<span class="doc-modal-icon" title="${tag}" style="color: ${color}">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="${iconPath}"/>
                        </svg>
                    </span>`;
                }
                return '';
            }).filter(html => html).join('');
        }

        // Stats
        const readingTimeEl = this.modal.querySelector('#doc-modal-reading-time');
        const wordsEl = this.modal.querySelector('#doc-modal-words');

        if (readingTimeEl) readingTimeEl.textContent = `${docData.readingTime} min`;
        if (wordsEl) wordsEl.textContent = `~${docData.wordCount} mots`;

        // Contenu
        const bodyEl = this.modal.querySelector('#doc-modal-body');
        if (bodyEl) {
            bodyEl.innerHTML = docData.htmlContent;
        }

        // Initialiser les boutons copier pour les code blocks
        this.initCodeCopyButtons();

        // Générer la table des matières
        this.generateTOC();

        // Scroll to top
        const contentEl = this.modal.querySelector('.doc-modal-content');
        if (contentEl) contentEl.scrollTop = 0;
    }

    showError() {
        const bodyEl = this.modal.querySelector('#doc-modal-body');
        if (bodyEl) {
            bodyEl.innerHTML = `
                <div style="text-align: center; padding: 3rem;">
                    <h3 style="color: #ff4444; margin-bottom: 1rem;">Erreur de chargement</h3>
                    <p style="color: rgba(255,255,255,0.6);">Impossible de charger cette documentation.</p>
                </div>
            `;
        }
    }

    navigatePrevious() {
        if (this.currentDocIndex > 0) {
            const prevDoc = this.allDocs[this.currentDocIndex - 1];
            this.openModal(prevDoc.slug, this.currentDocIndex - 1);
        }
    }

    navigateNext() {
        if (this.currentDocIndex < this.allDocs.length - 1) {
            const nextDoc = this.allDocs[this.currentDocIndex + 1];
            this.openModal(nextDoc.slug, this.currentDocIndex + 1);
        }
    }

    updateNavigationButtons() {
        if (this.prevButton) {
            this.prevButton.disabled = this.currentDocIndex <= 0;
        }
        if (this.nextButton) {
            this.nextButton.disabled = this.currentDocIndex >= this.allDocs.length - 1;
        }
    }

    handleUrlHash() {
        const hash = window.location.hash;
        if (hash.startsWith('#doc-')) {
            const slug = hash.replace('#doc-', '');
            const index = this.allDocs.findIndex(doc => doc.slug === slug);
            if (index !== -1) {
                this.openModal(slug, index);
            }
        }
    }
}

// Initialize Documentation Modal System
document.addEventListener('DOMContentLoaded', () => {
    window.docModalSystem = new DocModalSystem();
});

document.addEventListener('portfolioReady', () => {
    window.docModalSystem = new DocModalSystem();
});
