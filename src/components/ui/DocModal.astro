---
/**
 * DocModal.astro - Unified documentation modal (Skills-style)
 * Simplified version - no TOC, no terminal dots
 * @version 2.0 - Unified modal system
 */
---

<div id="doc-modal-overlay" class="unified-modal doc-unified-modal" data-modal-state="closed">
    <div class="modal-content modal-content-doc">
        <!-- Header -->
        <div class="modal-header">
            <h2 class="modal-title">
                <span class="doc-modal-category"></span>
                <span class="title-separator">/</span>
                <span class="modal-title-text doc-modal-title-text"></span>
            </h2>
            <div class="modal-nav">
                <button class="nav-btn" id="doc-modal-prev" disabled title="Précédent">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6" />
                    </svg>
                </button>
                <button class="nav-btn" id="doc-modal-next" disabled title="Suivant">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6" />
                    </svg>
                </button>
                <button class="modal-close" data-modal-close aria-label="Fermer">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- Meta info -->
        <div class="doc-modal-meta">
            <div class="meta-info">
                <span class="meta-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <span class="doc-modal-date"></span>
                </span>
                <span class="meta-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <path d="M12 6v6l4 2" />
                    </svg>
                    <span id="doc-modal-reading-time">5 min</span>
                </span>
            </div>
            <div class="doc-modal-tags" id="doc-modal-tags"></div>
        </div>

        <!-- Description -->
        <div class="doc-modal-description-bar">
            <p class="doc-modal-description"></p>
        </div>

        <!-- Content body -->
        <div class="doc-modal-body-wrapper">
            <div id="doc-modal-body" class="doc-modal-body markdown-content">
                <!-- Markdown content injected here -->
            </div>
        </div>

        <!-- Progress bar -->
        <div class="doc-progress-bar">
            <div class="doc-progress-fill"></div>
        </div>
    </div>
</div>

<style>
    /* Override unified modal for doc specifics */
    #doc-modal-overlay.doc-unified-modal {
        top: 0; /* Docs start from top */
        padding: 1rem;
    }

    #doc-modal-overlay .modal-content-doc {
        max-width: var(--modal-max-width-doc, 800px);
        max-height: 90vh;
        display: flex;
        flex-direction: column;
        padding: 0;
    }

    /* Header */
    #doc-modal-overlay .modal-header {
        padding: 1rem 1.5rem;
        margin-bottom: 0;
        border-bottom: 1px solid rgba(0, 255, 255, 0.2);
    }

    #doc-modal-overlay .modal-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        flex: 1;
        overflow: hidden;
    }

    #doc-modal-overlay .doc-modal-category {
        color: var(--neon-cyan);
        text-transform: uppercase;
        font-size: 1rem;
        flex-shrink: 0;
    }

    #doc-modal-overlay .title-separator {
        color: rgba(255, 255, 255, 0.25);
    }

    #doc-modal-overlay .doc-modal-title-text {
        color: #fff;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    /* Navigation buttons */
    #doc-modal-overlay .modal-nav {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        flex-shrink: 0;
    }

    #doc-modal-overlay .nav-btn {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--gray-light);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    #doc-modal-overlay .nav-btn:hover:not(:disabled) {
        border-color: var(--neon-cyan);
        color: var(--neon-cyan);
        background: rgba(0, 255, 255, 0.1);
    }

    #doc-modal-overlay .nav-btn:disabled {
        opacity: 0.3;
        cursor: not-allowed;
    }

    #doc-modal-overlay .nav-btn svg {
        width: 18px;
        height: 18px;
    }

    #doc-modal-overlay .modal-close {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--gray-light);
        cursor: pointer;
        transition: all 0.3s ease;
        padding: 0;
    }

    #doc-modal-overlay .modal-close:hover {
        border-color: var(--neon-magenta);
        color: var(--neon-magenta);
        background: rgba(255, 0, 128, 0.1);
    }

    #doc-modal-overlay .modal-close svg {
        width: 18px;
        height: 18px;
    }

    /* Meta bar */
    #doc-modal-overlay .doc-modal-meta {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
        padding: 0.75rem 1.5rem;
        background: rgba(0, 0, 0, 0.3);
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    #doc-modal-overlay .meta-info {
        display: flex;
        align-items: center;
        gap: 1.5rem;
    }

    #doc-modal-overlay .meta-item {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        font-family: 'Space Mono', monospace;
        font-size: 0.75rem;
        color: var(--gray-light);
    }

    #doc-modal-overlay .meta-item svg {
        width: 14px;
        height: 14px;
        color: var(--neon-cyan);
        opacity: 0.6;
    }

    #doc-modal-overlay .doc-modal-tags {
        display: flex;
        flex-wrap: nowrap;
        gap: 0.5rem;
        overflow-x: auto;
        max-width: 40%;
    }

    #doc-modal-overlay .doc-modal-tags::-webkit-scrollbar {
        height: 0;
    }

    #doc-modal-overlay .doc-modal-tags :global(.doc-modal-icon) {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    #doc-modal-overlay .doc-modal-tags :global(.doc-modal-icon svg) {
        width: 16px;
        height: 16px;
    }

    /* Description */
    #doc-modal-overlay .doc-modal-description-bar {
        padding: 0.75rem 1.5rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    #doc-modal-overlay .doc-modal-description {
        margin: 0;
        font-family: 'Space Mono', monospace;
        font-size: 0.8rem;
        color: var(--gray-light);
        line-height: 1.5;
        font-style: italic;
    }

    /* Body wrapper - no TOC, full width */
    #doc-modal-overlay .doc-modal-body-wrapper {
        flex: 1;
        overflow-y: auto;
        padding: 1.5rem;
        background: #000;
    }

    #doc-modal-overlay .doc-modal-body {
        max-width: 700px;
        margin: 0 auto;
    }

    #doc-modal-overlay .doc-modal-body-wrapper::-webkit-scrollbar {
        width: 6px;
    }

    #doc-modal-overlay .doc-modal-body-wrapper::-webkit-scrollbar-track {
        background: transparent;
    }

    #doc-modal-overlay .doc-modal-body-wrapper::-webkit-scrollbar-thumb {
        background: rgba(0, 255, 255, 0.2);
        border-radius: 3px;
    }

    /* Progress bar */
    #doc-modal-overlay .doc-progress-bar {
        height: 3px;
        background: rgba(255, 255, 255, 0.1);
        flex-shrink: 0;
    }

    #doc-modal-overlay .doc-progress-fill {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, var(--neon-cyan), var(--neon-magenta));
        transition: width 0.1s ease-out;
    }

    /* Markdown content styles */
    #doc-modal-overlay .markdown-content {
        color: var(--gray-lighter);
        line-height: 1.7;
    }

    #doc-modal-overlay .markdown-content h1,
    #doc-modal-overlay .markdown-content h2,
    #doc-modal-overlay .markdown-content h3 {
        font-family: 'Bebas Neue', sans-serif;
        color: #fff;
        margin-top: 2rem;
        margin-bottom: 1rem;
        letter-spacing: 0.03em;
    }

    #doc-modal-overlay .markdown-content h1 {
        font-size: 1.8rem;
        color: var(--neon-cyan);
        border-bottom: 2px solid var(--neon-cyan);
        padding-bottom: 0.5rem;
    }

    #doc-modal-overlay .markdown-content h2 {
        font-size: 1.4rem;
        color: var(--neon-cyan);
        padding-left: 0.75rem;
        border-left: 3px solid var(--neon-cyan);
    }

    #doc-modal-overlay .markdown-content h3 {
        font-size: 1.1rem;
        color: var(--gray-lighter);
    }

    #doc-modal-overlay .markdown-content p {
        margin-bottom: 1rem;
    }

    #doc-modal-overlay .markdown-content a {
        color: var(--neon-cyan);
        text-decoration: none;
        border-bottom: 1px solid transparent;
        transition: border-color 0.2s;
    }

    #doc-modal-overlay .markdown-content a:hover {
        border-bottom-color: var(--neon-cyan);
    }

    #doc-modal-overlay .markdown-content ul,
    #doc-modal-overlay .markdown-content ol {
        margin-bottom: 1rem;
        padding-left: 1.5rem;
    }

    #doc-modal-overlay .markdown-content li {
        margin-bottom: 0.5rem;
    }

    #doc-modal-overlay .markdown-content ul li::marker {
        color: var(--neon-cyan);
    }

    #doc-modal-overlay .markdown-content code {
        font-family: 'JetBrains Mono', monospace;
        background: rgba(0, 255, 255, 0.1);
        padding: 0.15rem 0.4rem;
        border-radius: 3px;
        font-size: 0.85em;
        color: var(--neon-cyan);
    }

    #doc-modal-overlay .markdown-content pre {
        background: #0a0a0a;
        border: 1px solid rgba(0, 255, 255, 0.2);
        border-radius: 4px;
        padding: 1rem;
        overflow-x: auto;
        margin-bottom: 1rem;
    }

    #doc-modal-overlay .markdown-content pre code {
        background: transparent;
        padding: 0;
        color: var(--gray-lighter);
    }

    #doc-modal-overlay .markdown-content blockquote {
        border-left: 3px solid var(--neon-magenta);
        margin: 1rem 0;
        padding: 0.5rem 0 0.5rem 1rem;
        background: rgba(255, 0, 128, 0.05);
        color: var(--gray-light);
        font-style: italic;
    }

    #doc-modal-overlay .markdown-content table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1rem;
    }

    #doc-modal-overlay .markdown-content th,
    #doc-modal-overlay .markdown-content td {
        padding: 0.5rem 0.75rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        text-align: left;
    }

    #doc-modal-overlay .markdown-content th {
        background: rgba(0, 255, 255, 0.1);
        color: var(--neon-cyan);
        font-weight: 600;
    }

    #doc-modal-overlay .markdown-content img {
        max-width: 100%;
        height: auto;
        border-radius: 4px;
        margin: 1rem 0;
    }

    /* Responsive */
    @media (max-width: 768px) {
        #doc-modal-overlay.doc-unified-modal {
            padding: 0;
        }

        #doc-modal-overlay .modal-content-doc {
            max-width: 100%;
            width: 100%;
            max-height: 100vh;
            border-radius: 0;
            border: none;
        }

        #doc-modal-overlay .modal-header {
            padding: 0.75rem 1rem;
        }

        #doc-modal-overlay .modal-title {
            font-size: 1rem;
        }

        #doc-modal-overlay .doc-modal-meta {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
        }

        #doc-modal-overlay .doc-modal-tags {
            max-width: 100%;
        }

        #doc-modal-overlay .doc-modal-description-bar {
            padding: 0.5rem 1rem;
        }

        #doc-modal-overlay .doc-modal-body-wrapper {
            padding: 1rem;
        }

        #doc-modal-overlay .nav-btn,
        #doc-modal-overlay .modal-close {
            width: 32px;
            height: 32px;
        }
    }
</style>
